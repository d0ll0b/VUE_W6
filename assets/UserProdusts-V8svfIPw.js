import{e as x,g as ut,_ as J,o as v,c as w,a as t,t as E,f as ht,v as _t,r as L,b as S,F as Y,h as pt,i as K,d as U}from"./index-hTMWHt8X.js";import{r as P,a as X,b as R,c as W,d as mt,e as ft,f as gt,M as bt}from"./MessageToast-xh-Gpjaf.js";import{P as Et}from"./PaginationBtn-ahKPvIJL.js";var Z={exports:{}},V={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var z;function At(){return z||(z=1,function(l,d){(function(e,s){l.exports=s(P(),X(),R())})(x,function(e,s,o){const h="backdrop",f="fade",c="show",m=`mousedown.bs.${h}`,A={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},_={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class r extends s{constructor(n){super(),this._config=this._getConfig(n),this._isAppended=!1,this._element=null}static get Default(){return A}static get DefaultType(){return _}static get NAME(){return h}show(n){if(!this._config.isVisible){o.execute(n);return}this._append();const g=this._getElement();this._config.isAnimated&&o.reflow(g),g.classList.add(c),this._emulateAnimation(()=>{o.execute(n)})}hide(n){if(!this._config.isVisible){o.execute(n);return}this._getElement().classList.remove(c),this._emulateAnimation(()=>{this.dispose(),o.execute(n)})}dispose(){this._isAppended&&(e.off(this._element,m),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const n=document.createElement("div");n.className=this._config.className,this._config.isAnimated&&n.classList.add(f),this._element=n}return this._element}_configAfterMerge(n){return n.rootElement=o.getElement(n.rootElement),n}_append(){if(this._isAppended)return;const n=this._getElement();this._config.rootElement.append(n),e.on(n,m,()=>{o.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(n){o.executeAfterTransition(n,this._getElement(),this._config.isAnimated)}}return r})}(V)),V.exports}var B={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var G;function Tt(){return G||(G=1,function(l,d){(function(e,s){l.exports=s(P(),W(),X())})(x,function(e,s,o){const h="focustrap",c=".bs.focustrap",m=`focusin${c}`,A=`keydown.tab${c}`,_="Tab",r="forward",i="backward",n={autofocus:!0,trapElement:null},g={autofocus:"boolean",trapElement:"element"};class T extends o{constructor(p){super(),this._config=this._getConfig(p),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return n}static get DefaultType(){return g}static get NAME(){return h}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),e.off(document,c),e.on(document,m,p=>this._handleFocusin(p)),e.on(document,A,p=>this._handleKeydown(p)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,e.off(document,c))}_handleFocusin(p){const{trapElement:k}=this._config;if(p.target===document||p.target===k||k.contains(p.target))return;const D=s.focusableChildren(k);D.length===0?k.focus():this._lastTabNavDirection===i?D[D.length-1].focus():D[0].focus()}_handleKeydown(p){p.key===_&&(this._lastTabNavDirection=p.shiftKey?i:r)}}return T})}(B)),B.exports}var I={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Q;function yt(){return Q||(Q=1,function(l,d){(function(e,s){l.exports=s(mt(),W(),R())})(x,function(e,s,o){const h=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",f=".sticky-top",c="padding-right",m="margin-right";class A{constructor(){this._element=document.body}getWidth(){const r=document.documentElement.clientWidth;return Math.abs(window.innerWidth-r)}hide(){const r=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,c,i=>i+r),this._setElementAttributes(h,c,i=>i+r),this._setElementAttributes(f,m,i=>i-r)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,c),this._resetElementAttributes(h,c),this._resetElementAttributes(f,m)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(r,i,n){const g=this.getWidth(),T=y=>{if(y!==this._element&&window.innerWidth>y.clientWidth+g)return;this._saveInitialAttribute(y,i);const p=window.getComputedStyle(y).getPropertyValue(i);y.style.setProperty(i,`${n(Number.parseFloat(p))}px`)};this._applyManipulationCallback(r,T)}_saveInitialAttribute(r,i){const n=r.style.getPropertyValue(i);n&&e.setDataAttribute(r,i,n)}_resetElementAttributes(r,i){const n=g=>{const T=e.getDataAttribute(g,i);if(T===null){g.style.removeProperty(i);return}e.removeDataAttribute(g,i),g.style.setProperty(i,T)};this._applyManipulationCallback(r,n)}_applyManipulationCallback(r,i){if(o.isElement(r)){i(r);return}for(const n of s.find(r,this._element))i(n)}}return A})}(I)),I.exports}/*!
  * Bootstrap modal.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(l,d){(function(e,s){l.exports=s(ft(),P(),W(),At(),gt(),Tt(),R(),yt())})(x,function(e,s,o,h,f,c,m,A){const _="modal",i=".bs.modal",n=".data-api",g="Escape",T=`hide${i}`,y=`hidePrevented${i}`,p=`hidden${i}`,k=`show${i}`,D=`shown${i}`,j=`resize${i}`,H=`click.dismiss${i}`,tt=`mousedown.dismiss${i}`,et=`keydown.dismiss${i}`,st=`click${i}${n}`,q="modal-open",it="fade",F="show",O="modal-static",ot=".modal.show",nt=".modal-dialog",at=".modal-body",rt='[data-bs-toggle="modal"]',lt={backdrop:!0,focus:!0,keyboard:!0},ct={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class N extends e{constructor(a,u){super(a,u),this._dialog=o.findOne(nt,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new A,this._addEventListeners()}static get Default(){return lt}static get DefaultType(){return ct}static get NAME(){return _}toggle(a){return this._isShown?this.hide():this.show(a)}show(a){this._isShown||this._isTransitioning||s.trigger(this._element,k,{relatedTarget:a}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(q),this._adjustDialog(),this._backdrop.show(()=>this._showElement(a)))}hide(){!this._isShown||this._isTransitioning||s.trigger(this._element,T).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(F),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){s.off(window,i),s.off(this._dialog,i),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new h({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new c({trapElement:this._element})}_showElement(a){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const u=o.findOne(at,this._dialog);u&&(u.scrollTop=0),m.reflow(this._element),this._element.classList.add(F);const b=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,s.trigger(this._element,D,{relatedTarget:a})};this._queueCallback(b,this._dialog,this._isAnimated())}_addEventListeners(){s.on(this._element,et,a=>{if(a.key===g){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),s.on(window,j,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),s.on(this._element,tt,a=>{s.one(this._element,H,u=>{if(!(this._element!==a.target||this._element!==u.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(q),this._resetAdjustments(),this._scrollBar.reset(),s.trigger(this._element,p)})}_isAnimated(){return this._element.classList.contains(it)}_triggerBackdropTransition(){if(s.trigger(this._element,y).defaultPrevented)return;const u=this._element.scrollHeight>document.documentElement.clientHeight,b=this._element.style.overflowY;b==="hidden"||this._element.classList.contains(O)||(u||(this._element.style.overflowY="hidden"),this._element.classList.add(O),this._queueCallback(()=>{this._element.classList.remove(O),this._queueCallback(()=>{this._element.style.overflowY=b},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const a=this._element.scrollHeight>document.documentElement.clientHeight,u=this._scrollBar.getWidth(),b=u>0;if(b&&!a){const C=m.isRTL()?"paddingLeft":"paddingRight";this._element.style[C]=`${u}px`}if(!b&&a){const C=m.isRTL()?"paddingRight":"paddingLeft";this._element.style[C]=`${u}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(a,u){return this.each(function(){const b=N.getOrCreateInstance(this,a);if(typeof a=="string"){if(typeof b[a]>"u")throw new TypeError(`No method named "${a}"`);b[a](u)}})}}return s.on(document,st,rt,function(dt){const a=o.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&dt.preventDefault(),s.one(a,k,C=>{C.defaultPrevented||s.one(a,p,()=>{m.isVisible(this)&&this.focus()})});const u=o.findOne(ot);u&&N.getInstance(u).hide(),N.getOrCreateInstance(a).toggle(this)}),f.enableDismissTrigger(N),m.defineJQueryPlugin(N),N})})(Z);var vt=Z.exports;const wt=ut(vt),kt={props:["product"],data(){return{userProductModal:"",qty:1}},methods:{show_Model(){this.userProductModal.show()},hide_Model(){this.userProductModal.hide()},add_cart(l,d,e){this.qty=1,this.$emit("add_cart",l,d,e)}},mounted(){this.userProductModal=new wt(this.$refs.modal,{keyboard:!1})}},Nt={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Dt={class:"modal-dialog modal-xl",role:"document"},Ct={class:"modal-content border-0"},Lt={class:"modal-header bg-dark text-white"},St={class:"modal-title",id:"exampleModalLabel"},Mt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$t={class:"modal-body"},xt={class:"row"},Ot={class:"col-sm-6"},Vt=["src"],Bt={class:"col-sm-6 text-start"},It={class:"badge bg-primary rounded-pill"},Pt={class:"h6"},Rt={class:"h5"},Wt={class:"input-group"};function qt(l,d,e,s,o,h){return v(),w("div",Nt,[t("div",Dt,[t("div",Ct,[t("div",Lt,[t("h5",St,[t("span",null,E(e.product.title),1)]),Mt]),t("div",$t,[t("div",xt,[t("div",Ot,[t("img",{class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,Vt)]),t("div",Bt,[t("span",It,E(e.product.category),1),t("p",null,"商品描述："+E(e.product.description),1),t("p",null,"商品內容："+E(e.product.content),1),t("del",Pt,"原價 "+E(e.product.origin_price)+" 元",1),t("div",Rt,"現在只要 "+E(e.product.price)+" 元",1),t("div",null,[t("div",Wt,[ht(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":d[0]||(d[0]=f=>o.qty=f)},null,512),[[_t,o.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:d[1]||(d[1]=f=>h.add_cart(e.product.id,o.qty,"new"))},"加入購物車")])])])])])])])],512)}const Ft=J(kt,[["render",qt]]),M="https://ec-course-api.hexschool.io/v2",$="dollob_api",Yt={data(){return{products:[],product:{},pagination:{},isLoading:!1}},components:{userProductModal:Ft,MessageToast:bt,PaginationBtn:Et},methods:{get_products(l=1){this.isLoading=!0;const d=`${M}/api/${$}/products?page=${l}`;this.axios.get(d).then(e=>{const{products:s,pagination:o}=e.data;this.products=s,this.pagination=o}).catch(e=>{alert(e)}).finally(()=>{this.isLoading=!1})},get_product(l){this.isLoading=!0;const d=`${M}/api/${$}/product/${l}`;this.axios.get(d).then(e=>{const{product:s}=e.data;this.product=s,this.$refs.userProductModal.show_Model()}).catch(e=>{alert(e)}).finally(()=>{this.isLoading=!1})},add_cart(l,d=1,e){let s="",o="";const h=`加入購物車成功，新增${d}筆商品~~`;this.isLoading=!0,e==="new"?(s=`${M}/api/${$}/cart`,o="post"):(s=`${M}/api/${$}/cart/${e}`,o="put");const f={product_id:l,qty:d};this.axios[o](s,{data:f}).then(c=>{this.toastMsg(h)}).catch(c=>{alert(c)}).finally(()=>{this.isLoading=!1,this.$refs.userProductModal.hide_Model()})},toastMsg(l){this.$refs.messageToast.show_toast(l)}},mounted(){this.get_products()}},Kt=t("h3",null,"產品列表",-1),Ut={class:"container"},zt={class:"mt-4"},Gt={class:"table align-middle"},Qt=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),Jt={style:{width:"200px"}},Xt=["src"],Zt={key:0,class:"h5"},jt={key:1},Ht={class:"h6"},te={class:"h5"},ee={class:"btn-group btn-group-sm"},se=["onClick"],ie={key:0,class:"fas fa-spinner fa-pulse"},oe=["onClick"],ne={key:0,class:"fas fa-spinner fa-pulse"};function ae(l,d,e,s,o,h){const f=L("VueLoading"),c=L("user-product-modal"),m=L("message-toast"),A=L("pagination-btn");return v(),w(Y,null,[Kt,S(f,{active:o.isLoading},null,8,["active"]),t("div",Ut,[t("div",zt,[S(c,{ref:"userProductModal",product:o.product,onAdd_cart:h.add_cart},null,8,["product","onAdd_cart"]),S(m,{ref:"messageToast"},null,512),t("table",Gt,[Qt,t("tbody",null,[(v(!0),w(Y,null,pt(o.products,_=>(v(),w("tr",{key:_.id},[t("td",Jt,[t("img",{src:_.imageUrl,style:{height:"100px","background-size":"cover","background-position":"center"}},null,8,Xt)]),t("td",null,E(_.title),1),t("td",null,[_.origin_price===_.price?(v(),w("div",Zt,E(_.price)+" 元",1)):(v(),w("div",jt,[t("del",Ht,"原價 "+E(_.origin_price)+" 元",1),t("div",te,"現在只要 "+E(_.price)+" 元",1)]))]),t("td",null,[t("div",ee,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:r=>h.get_product(_.id)},[o.isLoading?(v(),w("i",ie)):K("",!0),U(" 查看更多 ")],8,se),t("button",{type:"button",class:"btn btn-outline-danger",onClick:r=>h.add_cart(_.id,1,"new")},[o.isLoading?(v(),w("i",ne)):K("",!0),U(" 加到購物車 ")],8,oe)])])]))),128))])]),S(A,{pagination:o.pagination},null,8,["pagination"])])])],64)}const de=J(Yt,[["render",ae]]);export{de as default};
